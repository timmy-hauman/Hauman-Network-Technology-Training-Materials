<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EC-Council CND Module 04: Network Perimeter Security</title>
    <style>
        :root {
            --bg-color: #111111;
            --card-bg: #1a1a1a;
            --text-main: #e0e0e0;
            --text-muted: #a0a0a0;
            --accent-red: #FF0000;
            --accent-dim: #550000;
            --border-color: #333333;
            --glow: 0 0 10px rgba(255, 0, 0, 0.3);
            --font-head: 'Segoe UI', 'Roboto', Helvetica, Arial, sans-serif;
            --font-mono: 'Courier New', Courier, monospace;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: var(--font-head);
            margin: 0;
            padding: 0;
            line-height: 1.6;
            background-image: 
                linear-gradient(0deg, transparent 24%, rgba(255, 0, 0, .03) 25%, rgba(255, 0, 0, .03) 26%, transparent 27%, transparent 74%, rgba(255, 0, 0, .03) 75%, rgba(255, 0, 0, .03) 76%, transparent 77%, transparent),
                linear-gradient(90deg, transparent 24%, rgba(255, 0, 0, .03) 25%, rgba(255, 0, 0, .03) 26%, transparent 27%, transparent 74%, rgba(255, 0, 0, .03) 75%, rgba(255, 0, 0, .03) 76%, transparent 77%, transparent);
            background-size: 50px 50px;
        }

        /* Layout */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            border-bottom: 2px solid var(--accent-red);
            padding: 40px 0;
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }

        header::before {
            content: "CND_MODULE_04 // SYSTEM_READY";
            position: absolute;
            top: 10px;
            left: 0;
            font-family: var(--font-mono);
            font-size: 12px;
            color: var(--accent-red);
            opacity: 0.7;
        }

        h1 {
            font-size: 3rem;
            text-transform: uppercase;
            letter-spacing: 3px;
            margin: 0;
            text-shadow: var(--glow);
        }

        h2 {
            border-left: 5px solid var(--accent-red);
            padding-left: 15px;
            text-transform: uppercase;
            color: #fff;
            margin-top: 50px;
            margin-bottom: 30px;
            background: linear-gradient(90deg, rgba(255,0,0,0.1) 0%, transparent 100%);
        }

        /* Grid System */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        /* Cards */
        .card {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            padding: 25px;
            position: relative;
            transition: transform 0.3s, box-shadow 0.3s;
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            border-color: var(--accent-red);
        }

        .card::after {
            content: "";
            position: absolute;
            top: 0;
            right: 0;
            width: 20px;
            height: 20px;
            background: linear-gradient(45deg, transparent 50%, var(--accent-red) 50%);
            opacity: 0.5;
        }

        .card h3 {
            color: var(--accent-red);
            margin-top: 0;
            font-family: var(--font-mono);
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
        }

        .tag {
            display: inline-block;
            background: var(--accent-dim);
            color: #ffcccc;
            padding: 2px 8px;
            font-size: 0.8rem;
            border-radius: 2px;
            margin-bottom: 10px;
            font-family: var(--font-mono);
        }

        /* Content Styling */
        p {
            color: var(--text-muted);
            font-size: 0.95rem;
        }

        strong {
            color: #fff;
        }

        ul {
            padding-left: 20px;
            color: var(--text-muted);
        }

        li {
            margin-bottom: 8px;
        }

        .highlight-box {
            background: rgba(255, 0, 0, 0.05);
            border: 1px dashed var(--accent-red);
            padding: 15px;
            margin: 15px 0;
        }

        .blue-team-note {
            border-left: 3px solid #00aaff;
            background: rgba(0, 170, 255, 0.05);
            padding: 15px;
            margin-top: 15px;
        }
        .blue-team-note h4 {
            color: #00aaff;
            margin: 0 0 5px 0;
            font-size: 0.9rem;
            text-transform: uppercase;
        }

        /* HUD Elements */
        .hud-line {
            height: 1px;
            background: var(--border-color);
            width: 100%;
            margin: 40px 0;
            position: relative;
        }
        .hud-line::before {
            content: "";
            position: absolute;
            left: 50%;
            top: -5px;
            width: 10px;
            height: 10px;
            background: var(--accent-red);
            transform: rotate(45deg) translateX(-50%);
        }

        /* Quiz Section */
        #quiz-section {
            background: #0f0f0f;
            border: 1px solid var(--border-color);
            padding: 40px;
            margin-top: 60px;
            box-shadow: inset 0 0 50px rgba(0,0,0,0.8);
        }

        .quiz-question {
            margin-bottom: 30px;
            border-bottom: 1px solid #222;
            padding-bottom: 20px;
        }

        .question-text {
            font-size: 1.1rem;
            color: #fff;
            margin-bottom: 15px;
        }

        .options-grid {
            display: grid;
            gap: 10px;
        }

        .option-btn {
            background: #1a1a1a;
            border: 1px solid #444;
            color: #ccc;
            padding: 15px;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s;
            font-family: var(--font-head);
        }

        .option-btn:hover:not(:disabled) {
            background: #252525;
            border-color: #666;
        }

        .option-btn.correct {
            background: rgba(0, 255, 0, 0.1);
            border-color: #00ff00;
            color: #00ff00;
        }

        .option-btn.wrong {
            background: rgba(255, 0, 0, 0.1);
            border-color: #ff0000;
            color: #ff0000;
        }

        .feedback {
            margin-top: 10px;
            padding: 10px;
            font-size: 0.9rem;
            display: none;
        }
        
        .feedback.show {
            display: block;
        }

        /* Footer */
        footer {
            margin-top: 80px;
            padding: 20px;
            border-top: 1px solid #333;
            text-align: center;
            font-family: var(--font-mono);
            font-size: 0.8rem;
            color: #666;
            background: #000;
        }
        
        .cnd-intro {
            font-size: 1.2rem;
            color: var(--text-muted);
            max-width: 800px;
            margin: 0 auto 50px auto;
            text-align: center;
            border: 1px solid var(--border-color);
            padding: 20px;
            background: rgba(0,0,0,0.3);
        }

    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>EC-Council CND 網路防禦課程</h1>
        <div style="color: var(--accent-red); font-family: var(--font-mono); margin-top: 10px;">MODULE 04: NETWORK PERIMETER SECURITY</div>
    </header>

    <div class="cnd-intro">
        <p>本模組深入探討構建與維護安全網路邊界的核心技術。作為 CND 認證網路防禦者，您的任務不僅是部署設備，更是理解流量如何在邊界流動，並設計出能抵禦進階持續性威脅 (APT) 的縱深防禦架構。</p>
    </div>

    <!-- Section 1: Firewall Technologies -->
    <h2>1. 防火牆技術架構 (Firewall Architectures)</h2>
    <div class="grid">
        <div class="card">
            <span class="tag">LAYER 3/4</span>
            <h3>Packet Filtering (封包過濾)</h3>
            <p><strong>定義：</strong>最基礎的防火牆，僅檢查封包標頭 (IP, Port, Protocol)，不檢查 Payload。通常在 Router 上透過 ACL 實作。</p>
            <p><strong>Stateless (無狀態)：</strong>每一個封包被視為獨立事件。無法分辨該封包是屬於現有連線還是新的攻擊。</p>
            <div class="highlight-box">
                弱點：容易受到 IP Spoofing 攻擊；無法防禦應用層攻擊。
            </div>
            <div class="blue-team-note">
                <h4>Blue Team Tactic</h4>
                確保最後一條規則永遠是 "Explicit Deny" (Deny All)。
            </div>
        </div>

        <div class="card">
            <span class="tag">LAYER 3/4 + STATE</span>
            <h3>Stateful Inspection (狀態檢測)</h3>
            <p><strong>定義：</strong>除了檢查標頭，還維護一張「狀態表 (State Table)」。它知道封包是否屬於已建立的連線 (Established)。</p>
            <p><strong>運作：</strong>如果一個 ACK 封包進入，但狀態表中沒有對應的 SYN 記錄，則該封包會被丟棄。</p>
            <div class="highlight-box">
                優勢：比單純過濾更安全，效能比 Proxy 好。是現代防火牆的基礎。
            </div>
        </div>

        <div class="card">
            <span class="tag">LAYER 7</span>
            <h3>Application Proxy (應用層代理)</h3>
            <p><strong>定義：</strong>防火牆作為中間人 (Middleman)。客戶端連到 Proxy，Proxy 再連到伺服器。完全切斷了內外網的直接連線。</p>
            <p><strong>深度檢測：</strong>可以理解應用層協議 (如 HTTP, FTP)，能阻擋不符合 RFC 標準的指令。</p>
            <div class="blue-team-note">
                <h4>Blue Team Tactic</h4>
                使用 Proxy 來過濾特定的 HTTP 方法 (如阻擋 DELETE 或 TRACE) 以減少攻擊面。
            </div>
        </div>
    </div>

    <!-- Section 2: DMZ & Topology -->
    <div class="hud-line"></div>
    <h2>2. 網路拓樸與 DMZ 設計 (Topology & DMZ)</h2>
    <div class="grid">
        <div class="card">
            <h3>DMZ (非軍事區)</h3>
            <p><strong>概念：</strong>一個位於不受信任網路 (Internet) 與受信任內部網路 (LAN) 之間的緩衝區。</p>
            <p><strong>用途：</strong>放置必須對外提供服務的伺服器 (Public-Facing Servers)，例如：</p>
            <ul>
                <li>Web Server (HTTP/HTTPS)</li>
                <li>Mail Server (SMTP Relay)</li>
                <li>DNS Server (External)</li>
            </ul>
            <div class="highlight-box">
                關鍵規則：DMZ 中的主機<strong>絕對不應</strong>能夠直接發起連線進入內部網路 (LAN)。
            </div>
        </div>

        <div class="card">
            <h3>Bastion Host (堡壘主機)</h3>
            <p><strong>定義：</strong>為了承受攻擊而特別強化的電腦。通常放置在 DMZ 中。</p>
            <p><strong>Hardening (強化措施)：</strong></p>
            <ul>
                <li>移除所有不必要的服務與帳號。</li>
                <li>安裝最新的安全修補程式。</li>
                <li>關閉不必要的連接埠。</li>
            </ul>
        </div>

        <div class="card">
            <h3>Screened Subnet</h3>
            <p><strong>架構：</strong>使用兩個防火牆的架構。</p>
            <p>1. <strong>外部防火牆：</strong>過濾 Internet 到 DMZ 的流量。</p>
            <p>2. <strong>內部防火牆：</strong>過濾 DMZ 到 Internal LAN 的流量。</p>
            <div class="blue-team-note">
                <h4>Blue Team Tactic</h4>
                建議內外防火牆使用不同廠商的設備 (Vendor Diversity)，以避免單一漏洞導致全面淪陷。
            </div>
        </div>
    </div>

    <!-- Section 3: IDS vs IPS -->
    <div class="hud-line"></div>
    <h2>3. 入侵偵測與防禦 (IDS & IPS)</h2>
    
    <div style="background: #1a1a1a; padding: 20px; border: 1px solid #333; margin-bottom: 20px;">
        <h3 style="color: #fff;">Placement Strategy (部署策略)</h3>
        <p style="color: #bbb;">IDS 與 IPS 的部署位置決定了它們的效能與可視性。</p>
        <ul style="display: flex; flex-wrap: wrap; gap: 20px; list-style: none; padding: 0;">
            <li style="flex: 1; border: 1px solid #444; padding: 15px;">
                <strong style="color: var(--accent-red);">NIDS (Network IDS)</strong><br>
                部署在 Switch 的 Mirror Port (SPAN Port) 或網路分接器 (TAP)。<br>
                <em>被動監控，不影響網路延遲。</em>
            </li>
            <li style="flex: 1; border: 1px solid #444; padding: 15px;">
                <strong style="color: var(--accent-red);">NIPS (Network IPS)</strong><br>
                部署在網路路徑上 (Inline Mode)。<br>
                <em>主動攔截，但若設備故障可能導致網路中斷 (Fail-Open vs Fail-Closed)。</em>
            </li>
        </ul>
    </div>

    <div class="grid">
        <div class="card">
            <h3>Signature-Based (特徵碼偵測)</h3>
            <p>比對已知的攻擊特徵 (Pattern Matching)。</p>
            <p><strong>優點：</strong>誤報率 (False Positive) 低，偵測已知攻擊極快。</p>
            <p><strong>缺點：</strong>無法偵測 Zero-Day 攻擊。</p>
        </div>
        <div class="card">
            <h3>Anomaly-Based (行為/異常偵測)</h3>
            <p>先建立「正常流量基線 (Baseline)」，任何偏離基線的行為視為異常。</p>
            <p><strong>優點：</strong>可偵測未知的 Zero-Day 攻擊。</p>
            <p><strong>缺點：</strong>誤報率高 (例如流量突增可能只是因為促銷活動)。</p>
        </div>
    </div>

    <!-- Quiz Section -->
    <div id="quiz-section">
        <h2 style="margin-top: 0; border-left: none; padding-left: 0; text-align: center; color: var(--accent-red);">
            /// SYSTEM EVALUATION: CND SIMULATION EXAM ///
        </h2>
        <p style="text-align: center; margin-bottom: 40px;">Instructions: Select the best defensive action or analysis for the given scenarios.</p>

        <div id="quiz-container">
            <!-- Questions will be injected here by JS -->
        </div>
    </div>

</div>

<footer>
    Planning & Design by Timmy(timmyc@hauman.com.tw) | 豪勉科技 Hauman Technologies Corporation | Ver 1.0
</footer>

<script>
    const questions = [
        {
            id: 1,
            text: "一家企業將 Web Server 放置在防火牆後的內部網路 (LAN) 中，並透過 Port Forwarding 對外提供服務。身為 CND 防禦者，您認為這種架構最大的風險是什麼？",
            options: [
                { text: "Web Server 的效能會因為防火牆處理而降低。", correct: false },
                { text: "如果 Web Server 被駭客攻陷，攻擊者將直接立足於內部網路，無須經過第二層防護。", correct: true, explanation: "解析：這是最嚴重的架構錯誤。Web Server 應該放置在 DMZ。如果放在 LAN，一旦 Web Server 被攻破 (如透過 SQL Injection 取得 Shell)，駭客就可以直接橫向移動攻擊內網資料庫或 AD。" },
                { text: "外部使用者無法存取 HTTPS 加密流量。", correct: false },
                { text: "Port Forwarding 不支援動態 IP 分配。", correct: false }
            ]
        },
        {
            id: 2,
            text: "您正在設定防火牆規則以允許員工從家中透過 VPN 連線。為了遵循「最小權限原則 (Least Privilege)」，下列哪項設定最合適？",
            options: [
                { text: "Allow Any Source to VPN Gateway on Any Port", correct: false },
                { text: "Allow Any Source to VPN Gateway on Port 443 (SSL VPN) or UDP 500/4500 (IPsec)", correct: true, explanation: "解析：應只開啟 VPN 服務所需的特定 Port (如 SSL VPN 用 443，IPsec 用 UDP 500/4500)，並限制目的地僅為 VPN Gateway 介面，而非開放 Any Port。" },
                { text: "Allow Employee Home IP to Internal Network Any Port", correct: false },
                { text: "Allow VPN Gateway to Any Destination", correct: false }
            ]
        },
        {
            id: 3,
            text: "在檢視 IDS 日誌時，您發現大量的 TCP SYN 封包來自單一 IP，但都沒有後續的 ACK 回應。這最可能是什麼類型的攻擊？",
            options: [
                { text: "UDP Flood", correct: false },
                { text: "SQL Injection", correct: false },
                { text: "TCP SYN Flood (DoS Attack)", correct: true, explanation: "解析：這是典型的 SYN Flood 攻擊特徵。攻擊者發送大量 SYN 請求耗盡伺服器資源，但不完成三方交握 (不回傳 ACK)。" },
                { text: "Man-in-the-Middle Attack", correct: false }
            ]
        },
        {
            id: 4,
            text: "公司計畫部署入侵預防系統 (IPS) 來主動阻擋惡意流量。網路團隊擔心 IPS 的誤判 (False Positive) 會導致正常業務中斷。您應該建議採用哪種部署模式作為初期過渡？",
            options: [
                { text: "Inline Mode (串接模式)", correct: false },
                { text: "Promiscuous/Span Mode (監聽模式)", correct: true, explanation: "解析：在初期調校階段，建議先使用 Promiscuous Mode (或稱 Tap Mode)，讓設備僅偵測並發出告警 (Alert Only) 而不實際阻擋。待確認誤判率降低後，再切換為 Inline Mode 進行阻擋。" },
                { text: "Layer 2 Bridge Mode", correct: false },
                { text: "Router Mode", correct: false }
            ]
        },
        {
            id: 5,
            text: "Packet Filtering 防火牆 (Stateless) 與 Stateful Inspection 防火牆的主要區別在於：",
            options: [
                { text: "Packet Filtering 可以檢查應用層 Payload。", correct: false },
                { text: "Stateful Firewall 維護連線狀態表 (State Table)，能判斷封包是否屬於已建立的連線。", correct: true, explanation: "解析：Stateless 防火牆僅依據單一封包的標頭做決策；Stateful 防火牆則會記住連線狀態 (如 TCP Handshake 階段)，能阻擋不符合連線狀態的封包 (如憑空出現的 ACK)。" },
                { text: "Packet Filtering 效能比 Stateful 差。", correct: false },
                { text: "Stateful Firewall 不需要設定 ACL。", correct: false }
            ]
        },
        {
            id: 6,
            text: "您需要在 DMZ 中部署一台「堡壘主機 (Bastion Host)」作為公眾存取的 Web Server。下列哪項操作**不屬於**硬化 (Hardening) 的標準程序？",
            options: [
                { text: "移除編譯器 (Compilers) 和不必要的工具。", correct: false },
                { text: "停用不需要的服務和 Daemon。", correct: false },
                { text: "安裝所有可用的功能與套件以確保相容性。", correct: true, explanation: "解析：這是錯誤的。硬化原則要求「最小化安裝」，僅安裝運作所需的元件。安裝過多不必要的套件會增加攻擊面 (Attack Surface)。" },
                { text: "定期套用安全性修補程式 (Patches)。", correct: false }
            ]
        },
        {
            id: 7,
            text: "關於 VPN 通道協議，若您需要確保資料在傳輸過程中不僅被加密，還能驗證來源身分並確保資料完整性，IPsec 的哪種模式提供了最完整的保護？",
            options: [
                { text: "AH (Authentication Header) in Transport Mode", correct: false },
                { text: "ESP (Encapsulating Security Payload) in Tunnel Mode", correct: true, explanation: "解析：ESP 提供機密性 (加密)、資料完整性與來源驗證。Tunnel Mode 則會封裝整個原始 IP 封包，提供對流量模式的隱匿保護，是 Site-to-Site VPN 的標準配置。" },
                { text: "PPTP", correct: false },
                { text: "L2TP without IPsec", correct: false }
            ]
        },
        {
            id: 8,
            text: "為了防禦針對 Web 應用層的攻擊 (如 XSS, SQL Injection)，僅依賴傳統的 Layer 3/4 防火牆是不夠的。您應該建議導入什麼設備？",
            options: [
                { text: "WAF (Web Application Firewall)", correct: true, explanation: "解析：傳統防火牆無法理解 HTTP Payload 中的惡意腳本。WAF 專門運作於 Layer 7，能解析 HTTP/HTTPS 流量並阻擋 OWASP Top 10 等應用層攻擊。" },
                { text: "VLAN Segmentation", correct: false },
                { text: "Anti-Virus Server", correct: false },
                { text: "Load Balancer", correct: false }
            ]
        },
        {
            id: 9,
            text: "UTM (Unified Threat Management) 設備通常整合了防火牆、防毒、IPS 和內容過濾等功能。對於中小型企業而言，使用 UTM 的主要優勢為何？",
            options: [
                { text: "提供最高的單一功能效能 (Best-of-breed)。", correct: false },
                { text: "簡化管理複雜度並降低硬體成本。", correct: true, explanation: "解析：UTM 將多種資安功能整合在單一設備中，降低了採購與維運成本，適合資源有限的中小型企業。缺點是若 UTM 故障則所有防護失效 (Single Point of Failure)。" },
                { text: "完全消除所有網路延遲。", correct: false },
                { text: "不需要定期更新特徵碼。", correct: false }
            ]
        },
        {
            id: 10,
            text: "當攻擊者使用 IP Spoofing 偽造來源 IP 為內部網路位址 (如 192.168.1.x) 試圖穿透邊界防火牆時，下列哪種防禦機制最有效？",
            options: [
                { text: "Egress Filtering (出口過濾)", correct: false },
                { text: "Ingress Filtering (入口過濾) 配合 RFC 1918 檢查", correct: true, explanation: "解析：在邊界路由器或防火牆上設定 Ingress Filtering，丟棄所有從外部介面進入、但來源 IP 卻屬於內部私有網段 (RFC 1918) 的封包。這能有效阻擋外部的 IP 欺騙攻擊。" },
                { text: "增加 DHCP Lease Time", correct: false },
                { text: "使用 WPA3 加密", correct: false }
            ]
        }
    ];

    function renderQuiz() {
        const container = document.getElementById('quiz-container');
        let html = '';

        questions.forEach((q, index) => {
            html += `
                <div class="quiz-question" id="q${q.id}">
                    <div class="question-text">
                        <span style="color:var(--accent-red); font-weight:bold;">Q${q.id}:</span> ${q.text}
                    </div>
                    <div class="options-grid">
                        ${q.options.map((opt, i) => `
                            <button class="option-btn" onclick="checkAnswer(${q.id}, ${i}, this)">
                                ${['A', 'B', 'C', 'D'][i]}. ${opt.text}
                            </button>
                        `).join('')}
                    </div>
                    <div class="feedback" id="feedback-${q.id}"></div>
                </div>
            `;
        });

        container.innerHTML = html;
    }

    function checkAnswer(questionId, optionIndex, btnElement) {
        const question = questions.find(q => q.id === questionId);
        const feedbackEl = document.getElementById(`feedback-${questionId}`);
        const parentGrid = btnElement.parentElement;
        const allBtns = parentGrid.querySelectorAll('.option-btn');

        // Disable all buttons for this question
        allBtns.forEach(btn => btn.disabled = true);

        const selectedOpt = question.options[optionIndex];
        const correctOptIndex = question.options.findIndex(o => o.correct);
        const correctBtn = allBtns[correctOptIndex];

        if (selectedOpt.correct) {
            btnElement.classList.add('correct');
            feedbackEl.innerHTML = `<strong style="color:#00ff00;">[CORRECT]</strong> ${selectedOpt.explanation}`;
            feedbackEl.style.borderLeft = "3px solid #00ff00";
            feedbackEl.style.background = "rgba(0,255,0,0.05)";
        } else {
            btnElement.classList.add('wrong');
            correctBtn.classList.add('correct');
            feedbackEl.innerHTML = `<strong style="color:#ff0000;">[INCORRECT]</strong> ${question.options[correctOptIndex].explanation}`;
            feedbackEl.style.borderLeft = "3px solid #ff0000";
            feedbackEl.style.background = "rgba(255,0,0,0.05)";
        }
        
        feedbackEl.style.color = "#ccc";
        feedbackEl.classList.add('show');
    }

    // Initialize
    renderQuiz();
</script>

</body>
</html>