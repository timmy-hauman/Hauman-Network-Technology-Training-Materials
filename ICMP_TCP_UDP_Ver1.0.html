<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>網路協定大師班：ICMP, TCP & UDP 深度解析</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.1/mermaid.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; }
        
        /* Mermaid 優化設定 */
        .mermaid { 
            background-color: white; 
            padding: 20px; 
            border-radius: 12px; 
            display: flex; 
            justify-content: center; 
            overflow-x: auto;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        /* 修復文字被切斷的問題 */
        .mermaid svg { overflow: visible !important; }
        
        .tab-active { border-bottom: 3px solid #3B82F6; color: #1D4ED8; font-weight: bold; background-color: #EFF6FF; }
        .tab-inactive { color: #6B7280; hover:text-gray-800; hover:bg-gray-50; }
        .hidden-content { display: none; }
        
        /* 增加標籤按鈕的點擊區域與過渡效果 */
        button { transition: all 0.2s ease-in-out; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 flex flex-col min-h-screen">

    <!-- Header -->
    <header class="bg-gradient-to-r from-slate-800 to-slate-900 text-white p-6 shadow-lg">
        <div class="max-w-5xl mx-auto">
            <h1 class="text-3xl font-bold mb-2"><i class="fas fa-network-wired mr-2"></i>網路協定大師班</h1>
            <p class="text-slate-300">由 20 年資深網路架構師帶您深入核心：ICMP / TCP / UDP</p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow max-w-5xl mx-auto w-full p-4 sm:p-6">

        <!-- Introduction -->
        <div class="bg-white rounded-lg shadow p-6 mb-6 border-l-4 border-blue-500">
            <h2 class="text-xl font-bold mb-2 text-slate-800">👨‍🏫 架構師開講</h2>
            <p class="mb-4">
                歡迎來到進階網路課程。很多學員只知道 ping 會有回應，或者知道看影片用 UDP，但作為架構師，我們必須理解這些協定在封包層級的行為。
                今天我們不談死背，我會用我在業界 20 年的經驗，把這些生硬的協定變成你聽得懂的語言。
            </p>
            <div class="flex space-x-2 text-sm text-blue-600 bg-blue-50 p-2 rounded">
                <span class="font-bold">關鍵字：</span>
                <span>OSI L3/L4</span><span>•</span>
                <span>三方交握</span><span>•</span>
                <span>可靠性 vs 速度</span>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="flex border-b border-gray-200 mb-6 sticky top-0 bg-slate-50 z-10 shadow-sm">
            <button onclick="switchTab('icmp')" id="tab-icmp" class="tab-active flex-1 py-4 px-1 text-center cursor-pointer rounded-t-lg">
                ICMP (診斷)
            </button>
            <button onclick="switchTab('tcp')" id="tab-tcp" class="tab-inactive flex-1 py-4 px-1 text-center cursor-pointer rounded-t-lg">
                TCP (可靠傳輸)
            </button>
            <button onclick="switchTab('udp')" id="tab-udp" class="tab-inactive flex-1 py-4 px-1 text-center cursor-pointer rounded-t-lg">
                UDP (快速傳輸)
            </button>
            <button onclick="switchTab('quiz')" id="tab-quiz" class="tab-inactive flex-1 py-4 px-1 text-center cursor-pointer bg-yellow-50 hover:bg-yellow-100 rounded-t-lg">
                📝 隨堂測驗
            </button>
        </div>

        <!-- Content Area -->
        
        <!-- ICMP Section -->
        <div id="content-icmp" class="space-y-6">
            <!-- 1. Concept -->
            <section class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-2xl font-bold text-slate-800 mb-4 border-b pb-2">一、核心概念 (Concept)</h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-semibold text-blue-600">定義</h4>
                        <p>網際網路控制訊息協定 (Internet Control Message Protocol)。用於在 IP 網路上傳送控制訊息，提供錯誤報告與網路診斷。</p>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-indigo-700">💡 生活化比喻：道路施工與路況回報員</h4>
                        <p class="mt-2 text-sm">
                            ICMP 就像是高速公路上的「LED 告示牌」或「路況廣播」。它不運送貨物（不傳輸資料內容），而是告訴駕駛（傳送端）：「前方橋樑斷裂 (Destination Unreachable)」或「施工改道 (Redirect)」。<br>
                            <code>Ping</code> 就像是丟一顆網球出去，看它會不會彈回來，確認路通不通。
                        </p>
                    </div>
                </div>
            </section>

            <!-- 2. Mechanism -->
            <section class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-2xl font-bold text-slate-800 mb-4 border-b pb-2">二、運作原理 (Mechanism)</h3>
                <ul class="list-disc pl-5 space-y-2 text-slate-700">
                    <li><strong class="text-gray-900">層級：</strong> 運作於 OSI 模型第 3 層 (Network Layer)，雖然它被封裝在 IP 封包內，但它被視為 IP 的一部分。</li>
                    <li><strong class="text-gray-900">關鍵標頭欄位：</strong>
                        <ul class="list-none mt-1 ml-4 text-sm bg-gray-100 p-2 rounded">
                            <li><code>Type</code> (類型)：例如 Type 8 是 Echo Request (Ping 請求)，Type 0 是 Echo Reply (Ping 回應)。</li>
                            <li><code>Code</code> (代碼)：進一步說明 Type。例如 Type 3 (Destination Unreachable) 中，Code 1 代表 Host Unreachable。</li>
                        </ul>
                    </li>
                    <li><strong class="text-gray-900">無連接性：</strong> ICMP 不需要建立連線，發送即結束。</li>
                </ul>
            </section>

            <!-- 3. Visuals -->
            <section class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-2xl font-bold text-slate-800 mb-4 border-b pb-2">三、架構視覺化 (Visuals)</h3>
                <p class="mb-4 text-sm text-gray-500">
                    下圖展示標準的 Ping 流程，請注意箭頭方向代表封包流向：
                </p>
                <div class="mermaid">
                    sequenceDiagram
                        autonumber
                        participant Source as 💻 用戶端 (Source)
                        participant Router as 🛤️ 路由器 (Gateway)
                        participant Dest as 🖥️ 伺服器 (Destination)
                        
                        rect rgb(240, 255, 240)
                        Note over Source, Dest: 🟢 情況 A: 網路暢通 (Ping 成功) <br/>
                        Source->>Dest: ICMP Request (Type 8) ➡️ 請問你在嗎？
                        Dest-->>Source: ICMP Reply (Type 0) ⬅️ 我在！
                        end

                        rect rgb(255, 240, 240)
                        Note over Source, Router: 🔴 情況 B: 網路不通 (Destination Unreachable) <br/>
                        Source->>Router: ICMP Request (Type 8) ➡️ 我要找伺服器...
                        Router--xDest: ❌ 路徑中斷 / 防火牆阻擋
                        Router-->>Source: ICMP Dest. Unreachable (Type 3) ⬅️ 此路不通
                        end
                </div>
            </section>

            <!-- 4. Use Case -->
            <section class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-2xl font-bold text-slate-800 mb-4 border-b pb-2">四、實務應用場景 (Use Case)</h3>
                <div class="bg-green-50 border-l-4 border-green-500 p-4">
                    <h4 class="font-bold text-green-800">案例：網路連線故障排除 (Troubleshooting)</h4>
                    <p class="mt-2">當使用者抱怨「連不上 ERP 系統」時，網管人員的第一步通常不是檢查程式碼，而是：</p>
                    <ol class="list-decimal pl-5 mt-2 space-y-1 text-sm">
                        <li><code>ping 127.0.0.1</code>：檢查自己網卡堆疊是否正常。</li>
                        <li><code>ping Default Gateway</code>：檢查是否能出大門。</li>
                        <li><code>ping 8.8.8.8</code>：檢查外網是否通暢。</li>
                        <li><code>tracert (Windows) / traceroute (Linux)</code>：利用 ICMP TTL Time Exceeded 訊息來追蹤路徑上的每一跳。</li>
                    </ol>
                </div>
                <div class="mt-4 grid grid-cols-2 gap-4 text-sm">
                    <div class="p-3 bg-gray-50 rounded">
                        <span class="font-bold text-green-600">優點：</span> 簡單、快速、幾乎所有設備都支援，是診斷神器。
                    </div>
                    <div class="p-3 bg-gray-50 rounded">
                        <span class="font-bold text-red-600">缺點：</span> 易被防火牆阻擋 (ICMP Deny)，可能被用於 DDoS 攻擊 (Ping of Death, ICMP Flood)。
                    </div>
                </div>
            </section>
        </div>

        <!-- TCP Section -->
        <div id="content-tcp" class="space-y-6 hidden-content">
            <!-- 1. Concept -->
            <section class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-2xl font-bold text-slate-800 mb-4 border-b pb-2">一、核心概念 (Concept)</h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-semibold text-blue-600">定義</h4>
                        <p>傳輸控制協定 (Transmission Control Protocol)。一種連線導向 (Connection-oriented)、可靠的傳輸層協定。</p>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-indigo-700">💡 生活化比喻：掛號信或打電話</h4>
                        <p class="mt-2 text-sm">
                            TCP 就像寄送「雙掛號信」。
                            <br>1. 你寄出去 (SYN)。
                            <br>2. 對方收到並簽收，郵差通知你 (SYN-ACK)。
                            <br>3. 你確認收到回條 (ACK)。
                            <br>這保證了信件絕對送達，如果沒送達，郵局(TCP)會負責重寄，直到確認對方收到為止。
                        </p>
                    </div>
                </div>
            </section>

            <!-- 2. Mechanism -->
            <section class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-2xl font-bold text-slate-800 mb-4 border-b pb-2">二、運作原理 (Mechanism)</h3>
                <ul class="list-disc pl-5 space-y-2 text-slate-700">
                    <li><strong class="text-gray-900">層級：</strong> OSI 第 4 層 (Transport Layer)。</li>
                    <li><strong class="text-gray-900">可靠性機制：</strong>
                        <ul class="list-none mt-1 ml-4 text-sm bg-gray-100 p-2 rounded">
                            <li><strong>三方交握 (3-Way Handshake)：</strong> 建立連線前的必經儀式。</li>
                            <li><strong>序列號 (Sequence Number)：</strong> 確保資料順序正確，不會亂掉。</li>
                            <li><strong>確認應答 (ACK)：</strong> 收到封包要喊「有！」，沒喊就當作沒收到，發送端會重傳 (Retransmission)。</li>
                            <li><strong>流量控制 (Flow Control)：</strong> 透過 Window Size 告訴對方「我現在很忙，傳慢一點」。</li>
                        </ul>
                    </li>
                </ul>
            </section>

            <!-- 3. Visuals -->
            <section class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-2xl font-bold text-slate-800 mb-4 border-b pb-2">三、架構視覺化 (Visuals)</h3>
                <p class="mb-4 text-sm text-gray-500">
                    圖中背景色塊區分了三個階段，請留意箭頭標示的數據流向：
                </p>
                <div class="mermaid">
                    sequenceDiagram
                        autonumber
                        participant C as 💻 客戶端 (Client)
                        participant S as 🖥️ 伺服器 (Server)
                        
                        rect rgb(235, 245, 255)
                        Note over C, S: 🟢 第一階段：建立連線 (三方交握) <br/>
                        C->>S: SYN (Seq=x) ➡️ 哈囉，我想連線
                        S-->>C: SYN, ACK (Seq=y, Ack=x+1) ⬅️ 收到了，我也想連，這是我的號碼
                        C->>S: ACK (Seq=x+1, Ack=y+1) ➡️ 好，那我們開始吧
                        end
                        
                        Note right of C: ✅ 連線建立 (ESTABLISHED) <br/>
                        
                        rect rgb(255, 250, 240)
                        Note over C, S: 🔵 第二階段：資料傳輸 (可靠保證) <br/>
                        C->>S: Data (HTTP Request) ➡️ 請求網頁資料
                        S-->>C: ACK ⬅️ 收到請求了
                        S->>C: Data (HTTP Response) ⬅️ 給你網頁資料
                        C-->>S: ACK ➡️ 收到資料了
                        end
                        
                        rect rgb(255, 240, 245)
                        Note over C, S: 🔴 第三階段：斷開連線 (四次揮手) <br/>
                        C->>S: FIN ➡️ 我講完了，要掛電話了
                        S-->>C: ACK ⬅️ 知道了，請稍等...
                        S->>C: FIN ⬅️ 好，我也講完了
                        C-->>S: ACK ➡️ 好的，拜拜
                        end
                </div>
            </section>

            <!-- 4. Use Case -->
            <section class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-2xl font-bold text-slate-800 mb-4 border-b pb-2">四、實務應用場景 (Use Case)</h3>
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4">
                    <h4 class="font-bold text-blue-800">案例：銀行交易資料傳輸 / 網頁瀏覽 (HTTP/HTTPS)</h4>
                    <p class="mt-2">當你在轉帳時，絕對不能發生「封包掉了就不見了」這種事。TCP 保證每一個位元都準確無誤地到達。</p>
                </div>
                <div class="mt-4 grid grid-cols-2 gap-4 text-sm">
                    <div class="p-3 bg-gray-50 rounded">
                        <span class="font-bold text-green-600">優點：</span> 高可靠性、資料完整、有序、擁塞控制避免網路癱瘓。
                    </div>
                    <div class="p-3 bg-gray-50 rounded">
                        <span class="font-bold text-red-600">缺點：</span> 標頭大 (20 Bytes)、建立連線慢、即時性較差 (重傳機制導致延遲)。
                    </div>
                </div>
            </section>
        </div>

        <!-- UDP Section -->
        <div id="content-udp" class="space-y-6 hidden-content">
            <!-- 1. Concept -->
            <section class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-2xl font-bold text-slate-800 mb-4 border-b pb-2">一、核心概念 (Concept)</h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-semibold text-blue-600">定義</h4>
                        <p>使用者資料包協定 (User Datagram Protocol)。一種非連線導向 (Connectionless)、盡力傳送 (Best-effort) 的傳輸層協定。</p>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-indigo-700">💡 生活化比喻：廣播或平信</h4>
                        <p class="mt-2 text-sm">
                            UDP 就像「村長廣播」或是「丟紙飛機」。
                            <br>村長拿著麥克風喊話，他只負責喊出去，不管你聽不聽得清楚，也不管你有沒有在聽。
                            <br>講求的是「快」和「即時」，漏聽一兩個字通常不影響整體理解。
                        </p>
                    </div>
                </div>
            </section>

            <!-- 2. Mechanism -->
            <section class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-2xl font-bold text-slate-800 mb-4 border-b pb-2">二、運作原理 (Mechanism)</h3>
                <ul class="list-disc pl-5 space-y-2 text-slate-700">
                    <li><strong class="text-gray-900">層級：</strong> OSI 第 4 層 (Transport Layer)。</li>
                    <li><strong class="text-gray-900">輕量化設計：</strong>
                        <ul class="list-none mt-1 ml-4 text-sm bg-gray-100 p-2 rounded">
                            <li><strong>無連線 (Connectionless)：</strong> 發送前不需要握手，直接把資料丟出去。</li>
                            <li><strong>無狀態 (Stateless)：</strong> 不追蹤封包順序，不負責重傳。</li>
                            <li><strong>低開銷 (Low Overhead)：</strong> 標頭只有 8 Bytes (TCP 是 20 Bytes)，處理速度極快。</li>
                        </ul>
                    </li>
                </ul>
            </section>

            <!-- 3. Visuals -->
            <section class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-2xl font-bold text-slate-800 mb-4 border-b pb-2">三、架構視覺化 (Visuals)</h3>
                <p class="mb-4 text-sm text-gray-500">UDP 的流程非常單純，沒有握手階段，就是單向持續發送：</p>
                <div class="mermaid">
                    sequenceDiagram
                        autonumber
                        participant Sender as 📹 直播主 (Sender)
                        participant Receiver as 📺 觀眾 (Receiver)
                        
                        rect rgb(255, 248, 240)
                        Note over Sender, Receiver: ⚡ 快速傳輸模式 (無須等待 ACK) <br/>
                        Sender->>Receiver: UDP Datagram (影像 Frame 1) ➡️
                        Sender->>Receiver: UDP Datagram (影像 Frame 2) ➡️
                        Sender-xReceiver: UDP Datagram (影像 Frame 3 - 遺失) ❌
                        Note right of Receiver: 沒收到就算了，畫面小卡頓不影響 <br/>
                        Sender->>Receiver: UDP Datagram (影像 Frame 4) ➡️
                        end
                </div>
            </section>

            <!-- 4. Use Case -->
            <section class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-2xl font-bold text-slate-800 mb-4 border-b pb-2">四、實務應用場景 (Use Case)</h3>
                <div class="bg-orange-50 border-l-4 border-orange-500 p-4">
                    <h4 class="font-bold text-orange-800">案例：即時視訊會議 (Zoom/Teams) / 語音通話 (VoIP)</h4>
                    <p class="mt-2">
                        在視訊會議中，畫面偶爾馬賽克 (掉封包) 是可以接受的。但如果為了補救那個馬賽克而讓畫面停頓 3 秒 (TCP 重傳)，會議就開不下去了。<br>
                        另外，<strong>DNS 查詢</strong> 和 <strong>DHCP</strong> 也常使用 UDP，因為請求很短，不需要建立複雜連線。
                    </p>
                </div>
                <div class="mt-4 grid grid-cols-2 gap-4 text-sm">
                    <div class="p-3 bg-gray-50 rounded">
                        <span class="font-bold text-green-600">優點：</span> 速度快、延遲低、消耗資源少。
                    </div>
                    <div class="p-3 bg-gray-50 rounded">
                        <span class="font-bold text-red-600">缺點：</span> 不可靠、無順序保證、無擁塞控制 (容易把頻寬塞爆)。
                    </div>
                </div>
            </section>
        </div>

        <!-- Quiz Section -->
        <div id="content-quiz" class="hidden-content">
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-2xl font-bold text-slate-800 mb-6 text-center">🎓 架構師隨堂測驗</h3>
                <p class="text-center text-gray-500 mb-8">請嘗試回答下列問題，點擊按鈕查看解析。</p>

                <div class="space-y-6">
                    <!-- Q1 -->
                    <div class="border border-gray-200 rounded-lg p-4">
                        <p class="font-bold text-lg mb-2">Q1. 哪一個協定在傳輸資料前，必須先進行「三方交握」？</p>
                        <ul class="list-decimal pl-5 mb-3 text-slate-700">
                            <li>UDP</li>
                            <li>ICMP</li>
                            <li>TCP</li>
                            <li>IP</li>
                        </ul>
                        <button onclick="toggleAnswer('a1')" class="text-sm bg-blue-100 text-blue-600 px-3 py-1 rounded hover:bg-blue-200">👀 查看答案與解析</button>
                        <div id="a1" class="hidden mt-3 p-3 bg-green-50 text-green-800 rounded text-sm">
                            <strong>答案：3 (TCP)</strong><br>
                            解析：TCP 是連線導向協定，必須透過 SYN, SYN-ACK, ACK 三步驟建立可靠連線後才開始傳資料。
                        </div>
                    </div>

                    <!-- Q2 -->
                    <div class="border border-gray-200 rounded-lg p-4">
                        <p class="font-bold text-lg mb-2">Q2. 當我們使用 Ping 指令測試網路連通性時，底層使用的是哪種協定？</p>
                        <ul class="list-decimal pl-5 mb-3 text-slate-700">
                            <li>TCP Port 80</li>
                            <li>UDP Port 53</li>
                            <li>ICMP</li>
                            <li>ARP</li>
                        </ul>
                        <button onclick="toggleAnswer('a2')" class="text-sm bg-blue-100 text-blue-600 px-3 py-1 rounded hover:bg-blue-200">👀 查看答案與解析</button>
                        <div id="a2" class="hidden mt-3 p-3 bg-green-50 text-green-800 rounded text-sm">
                            <strong>答案：3 (ICMP)</strong><br>
                            解析：Ping 使用 ICMP Echo Request (Type 8) 與 Echo Reply (Type 0)。它不使用 TCP 或 UDP 的 Port 號。
                        </div>
                    </div>

                    <!-- Q3 -->
                    <div class="border border-gray-200 rounded-lg p-4">
                        <p class="font-bold text-lg mb-2">Q3. 在 VoIP (網路語音) 或 直播應用中，通常首選哪種傳輸層協定？為什麼？</p>
                        <ul class="list-decimal pl-5 mb-3 text-slate-700">
                            <li>TCP，因為聲音不能斷斷續續。</li>
                            <li>UDP，因為即使遺失少量封包，即時性比完整性更重要。</li>
                            <li>ICMP，因為可以隨時回報錯誤。</li>
                            <li>HTTP，因為通用性最高。</li>
                        </ul>
                        <button onclick="toggleAnswer('a3')" class="text-sm bg-blue-100 text-blue-600 px-3 py-1 rounded hover:bg-blue-200">👀 查看答案與解析</button>
                        <div id="a3" class="hidden mt-3 p-3 bg-green-50 text-green-800 rounded text-sm">
                            <strong>答案：2 (UDP)</strong><br>
                            解析：即時應用最怕延遲 (Latency)。TCP 的重傳機制會導致畫面停頓，而 UDP 雖然會掉封包 (畫面馬賽克)，但能保持即時串流不中斷。
                        </div>
                    </div>

                     <!-- Q4 -->
                     <div class="border border-gray-200 rounded-lg p-4">
                        <p class="font-bold text-lg mb-2">Q4. 下列關於 Header (標頭) 大小的敘述，何者正確？</p>
                        <ul class="list-decimal pl-5 mb-3 text-slate-700">
                            <li>TCP 與 UDP 的標頭一樣大。</li>
                            <li>TCP 標頭最小為 20 Bytes，UDP 標頭固定為 8 Bytes。</li>
                            <li>UDP 標頭比 TCP 大，因為它要處理廣播。</li>
                            <li>ICMP 屬於 Layer 4，所以也有 Port Number。</li>
                        </ul>
                        <button onclick="toggleAnswer('a4')" class="text-sm bg-blue-100 text-blue-600 px-3 py-1 rounded hover:bg-blue-200">👀 查看答案與解析</button>
                        <div id="a4" class="hidden mt-3 p-3 bg-green-50 text-green-800 rounded text-sm">
                            <strong>答案：2</strong><br>
                            解析：TCP 因為要處理序列號、ACK、Window Size 等，標頭較大 (至少 20B)；UDP 追求輕量，標頭僅包含來源/目的 Port、長度與 Checksum (8B)。
                        </div>
                    </div>

                    <!-- Q5 -->
                    <div class="border border-gray-200 rounded-lg p-4">
                        <p class="font-bold text-lg mb-2">Q5. 防火牆規則設定 `Deny Any` 後，為什麼 Ping 不到了？</p>
                        <ul class="list-decimal pl-5 mb-3 text-slate-700">
                            <li>因為 TCP Port 7 被封鎖。</li>
                            <li>因為 UDP 封包遺失。</li>
                            <li>因為 ICMP 協定被防火牆阻擋。</li>
                            <li>因為網路線被拔掉了。</li>
                        </ul>
                        <button onclick="toggleAnswer('a5')" class="text-sm bg-blue-100 text-blue-600 px-3 py-1 rounded hover:bg-blue-200">👀 查看答案與解析</button>
                        <div id="a5" class="hidden mt-3 p-3 bg-green-50 text-green-800 rounded text-sm">
                            <strong>答案：3</strong><br>
                            解析：Ping 依賴 ICMP 協定。許多企業為了資安隱密性，會在防火牆上阻擋 ICMP 封包，導致雖然服務正常，但無法被 Ping 到。
                        </div>
                    </div>

                </div>
            </div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-slate-900 text-slate-400 py-6 mt-8">
        <div class="max-w-5xl mx-auto px-4 text-center text-sm">
            <p>Planning & Design by Timmy(timmyc@hauman.com.tw) | 豪勉科技 Hauman Technologies Corporation | Ver 1.0</p>
        </div>
    </footer>

    <!-- JavaScript for Interactivity -->
    <script>
        function initializeMermaid() {
            mermaid.initialize({ 
                startOnLoad: false, // Wait for manual init
                theme: 'neutral',
                fontFamily: '"Noto Sans TC", sans-serif',
                sequence: {
                    noteMargin: 15,
                    boxMargin: 10,
                    boxTextMargin: 10,
                    messageMargin: 10,
                    mirrorActors: false,
                    bottomMarginAdj: 10
                },
                themeVariables: {
                    fontFamily: '"Noto Sans TC", sans-serif',
                    fontSize: '16px'
                }
            });
            
            // Run mermaid initialization on all .mermaid elements
            mermaid.init(undefined, document.querySelectorAll('.mermaid'));
        }

        // Wait for fonts to be ready before initializing mermaid to ensure correct box calculation
        document.fonts.ready.then(function () {
            initializeMermaid();
        });

        function switchTab(tabName) {
            // Hide all contents
            ['icmp', 'tcp', 'udp', 'quiz'].forEach(t => {
                document.getElementById('content-' + t).classList.add('hidden-content');
                document.getElementById('tab-' + t).classList.remove('tab-active', 'border-blue-500', 'text-blue-600', 'bg-blue-50');
                document.getElementById('tab-' + t).classList.add('tab-inactive');
            });

            // Show selected content
            document.getElementById('content-' + tabName).classList.remove('hidden-content');
            
            // Activate tab styling
            const activeTab = document.getElementById('tab-' + tabName);
            activeTab.classList.remove('tab-inactive');
            activeTab.classList.add('tab-active');
        }

        function toggleAnswer(id) {
            const element = document.getElementById(id);
            if (element.classList.contains('hidden')) {
                element.classList.remove('hidden');
            } else {
                element.classList.add('hidden');
            }
        }
    </script>
</body>
</html>